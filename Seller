using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;

namespace TestDrive
{
    class Pacman
    {
        static void Main(string[] args)
        {
            bool isOpen = true;
            string userInput;
            Buyer buyer = new Buyer();
            Seller seller = new Seller();
            Console.WriteLine("Добро пожаловать в магазин");
            Console.WriteLine("1.Показать покупки. 2.Показать товары. 3.Купить. 4.Выйти из магазина");

            while (isOpen)
            {
                userInput = Console.ReadLine();

                switch (userInput)
                {
                    case "1":
                        buyer.ShowPurchases();
                        break;
                    case "2":
                        seller.ShowGoods();
                        break;
                    case "3":
                        buyer.BuyItem(seller);
                        break;                    
                    case "4":
                        isOpen = false;
                        break;
                }
            }
        }
    }

    class Product
    {
        public string Name { get; private set; }
        public int Price { get; private set; }

        public Product(string name, int price)
        {
            Name = name;
            Price = price;
        } 
        
        public void ShowProduct(int productID)
        {
            Console.WriteLine($"{productID + 1}.{Name}, Цена {Price}");
        }
    }          

    class Buyer
    {        
        private Seller _seller = new Seller();
        private List<Buyer> _products = new List<Buyer>();
        private int _money = 2000;
        private string _productName;

        public Buyer(string productName)
        {
            _productName = productName;
        }
        public Buyer() { }

        public void ShowPurchases()
        {
            Console.WriteLine($"Ваши деньги {_money}");

            for (int i = 0; i < _products.Count; i++)
            {
                Console.WriteLine($"В вашей сумке {_products[i]._productName}");
            }       
        }        
                        
        public void BuyItem(Seller seller)
        {
            int itemID;
            Console.WriteLine("Что вы хотите купить?");
            itemID = GetNumber();

            if (itemID <= _seller.GetProducts().Count)
            {
                if (PurchasingAbility(seller, itemID - 1))
                {
                    _money -= seller.GetProducts()[itemID - 1].Price;
                    _products.Add(new Buyer(seller.GetProducts()[itemID - 1].Name));
                    seller.SellItem(itemID - 1);                    
                }
                else
                {
                    Console.WriteLine("У вас не хватает денег");
                }                
            }
            else
            {
                Console.WriteLine("Нет такого товара");
            }
        }
        
        private bool PurchasingAbility(Seller seller, int itemID)
        {
            if (_money - seller.GetProducts()[itemID].Price >= 0)
            {
                return true;
            }
            else
            {
                return false;
            }
        }

        private int GetNumber()
        {
            bool isNumber = int.TryParse(Console.ReadLine(), out int number);

            if (isNumber == false)
            {
                Console.WriteLine("Введите число");
                number = 0;
                return number;
            }
            else
            {
                return number;
            }
        }
    }

    class Seller
    {
        private List<Product> _products = new List<Product>();
        private int _shopAccount = 200;

        public Seller()
        {
            _products.Add(new Product("Брюки", 950));
            _products.Add(new Product("Ботинки", 650));
            _products.Add(new Product("Рубашка", 200));
            _products.Add(new Product("Пиджак", 1000));
            _products.Add(new Product("Галстук", 100));
        }

        public List<Product> GetProducts()
        {
            List<Product> products = new List<Product>();

            for (int i = 0; i < _products.Count; i++)
            {
                products.Add(_products[i]);
            }
            return products;
        }

        public void SellItem(int itemID)
        {
            _shopAccount += _products[itemID].Price;
        }

        public void ShowGoods()
        {
            Console.WriteLine($"Товары в магазине.   Деньги торговца {_shopAccount}");

            for (int i = 0; i < _products.Count; i++)
            {
                _products[i].ShowProduct(i);
            }
        }        
    }
}
